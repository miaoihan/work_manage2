<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Document</title>
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/static/editor/css/editormd.css">
    <link rel="stylesheet" href="/static/css/materialize.min.css">
    <link rel="stylesheet" href="/static/css/style.css">

    <body>
        <!-- markdown editor -->
        <!-- Modal Structure -->
        <div id="modal1" class="modal bottom-sheet" style="max-height:90%;">
            <form id="form1" action="/question/add" method="post">
                <div class="e-t-wrapp">
                    <input type="text" placeholder="请输入标题..." style="border:none;font-size: 20px;
    padding-left: 8px;width: 90%;" name="title">
                    <a class="btn right" onclick="subme()">提交</a>
                </div>
                <div class="clear"></div>
                <div id="editormd">
                    <textarea name="content_md" id="txt_md"></textarea>
                </div>
                <input name="content_html" id="txt_html" type="hidden">
            </form>
        </div>
        <!--
                <div class="editor-modal" id="editor">
                    <div>提交</div>
                    <div id="editormd" style="position:fixed;bottom:0;margin-left:5%;">
                        <textarea> </textarea>
                    </div>
                </div>
-->
        <!--导航栏-->
        <nav class="nav-top">
            <div class="nav-wrapper"> <a href="/" class="left brand-logo" style="font-size:22px;">码蜂社</a>
                <ul id="nav-mobile" class="right" style="margin-right: 20px">
                    {% if user %}
                    <li>你好，{{user.username}}</li>
                    <li><a href="/user/logout">登出</a></li>
                    {% else %}
                    <li><a href="/user/login">登录</a></li>
                    <li><a href="/user/register">注册</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        <div class="container">
            <!--面包屑-->
            <div class="crumbs-wrapper zcard content-20"> <a href="#!" class="">首页</a> / <a href="#!" class="">论坛</a> / <a href="#!" class="active">前端</a> </div>
            <div style="margin-bottom: 15px;">
                <!-- Modal Trigger -->
                {% if user %}
                <a class="modal-trigger waves-effect waves-light btn" href="#modal1">新主题</a> 
                {% else %}
                <a class="modal-trigger waves-effect waves-light btn" href="/user/login">登陆后发表</a> 
                {% endif %}
            </div>

            <div class="c-content row">
                <div class="col m8 s12">
                    <div class="que-list  zcard">
                        <div class="que-item row">
                            <div class="hot-left col m7 s12">
                                <a href="/question/details?id={{newQue.id}}">
                                    <div class="h-l-inner card"> 最新作业任务 </div>
                                </a>
                            </div>
                            <div class="hot-right col m5 s12">
                                <div class="h-r-top">
                                    <h2><a href="/question/details?id={{newQue.id}}">{{ newQue.title }}</a></h2> <span class="right"><img src="" alt=""></span> </div>
                                <div class="clear"></div>
                                <div class="h-r-content">
                                    {{ newQue.content_html | safe }}
                                </div>
                            </div>
                        </div>
                        {% for question in quePageData.data %}
                        <div class="que-item">
                            <h2 class="item-title">
                                <a href="/question/details?id={{question.id}}"><span>{{question.title}}</span></a>
                                <span class="i-t-time right">{{question.created_time | parseTime}}</span>
                            </h2>
                            <div class="clear"></div>
                            <div class="item-content"> {{question.content_html | safe}}</div>
                            <div class="item-meta"> <span>Jason</span> <span>任务</span> <span>116</span> <span>12</span> </div>
                        </div>
                        {% endfor %}
                    </div>
                    <!-- end list -->

                    <!-- 分页 -->
                    <div style="text-align:center;margin:20px 0;">
                        <ul class="pagination">
                            <li class="waves-effect" id="page_pre"><a href="?page={{quePageData.currentPage-1}}"><i class="material-icons">chevron_left</i></a></li>
                            {% for i in range(1,quePageData.totalPages+1) %}
                            <li id="page_{{i}}"><a href="?page={{i}}">{{i}}</a></li>
                            {% endfor %}
                            <li class="waves-effect" id="page_next"><a href="?page={{quePageData.currentPage+1}}"><i class="material-icons">chevron_right</i></a></li>
                        </ul>
                    </div>
                </div>
                <section class="c-right  col m3 s10 zcard" style="padding:30px 15px;margin-left:30px">
                    <div style="color:#999;font-size:14px;font-weight:600">热门任务</div>
                    <div class="hot-tesk-list">
                        <div class="tesk-item">
                            <div class="hot-tesk-title"><a href="#">关于微信交互的认知</a></div>
                            <div class="hot-tesk-meta"> <span>7168</span> <span style="margin-left:15px;">532</span> </div>
                        </div>
                        <div class="tesk-item">
                            <div class="hot-tesk-title"><a href="">从接触编程到工作，你们对编程的认识是一个怎样的变化过程</a></div>
                            <div class="hot-tesk-meta"> <span>7168</span> <span style="margin-left:15px;">532</span> </div>
                        </div>
                        <div class="tesk-item">
                            <div class="hot-tesk-title"><a href="">国内有哪些公司在用Vue.js</a></div>
                            <div class="hot-tesk-meta"> <span>7168</span> <span style="margin-left:15px;">532</span> </div>
                        </div>
                        <div class="tesk-item">
                            <div class="hot-tesk-title"><a href="">如何看待 CSS 中 BEM 的命名方式</a></div>
                            <div class="hot-tesk-meta"> <span>7168</span> <span style="margin-left:15px;">532</span> </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        <footer>
            <div class="Copyright "> Copyright © 2016 码蜂社 京公网安备 26015792005034号 </div>
        </footer>
        <script src="/static/js/jquery.min.js"></script>
        <script src="/static/js/materialize.min.js"></script>
        <script src='/static/editor/editormd.min.js'></script>
        <script>
            

            function showModal() {
                // document.getElementById('editor').style.display = 'block'
                //                $('editor').css('display','block')

            }

            $(document).ready(function() {
                // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
                $('.modal').modal();
                
                //分页
                $('#page_{{quePageData.currentPage}}').addClass('active')
                if({{quePageData.currentPage == 1}})
                    $('#page_pre').addClass('disabled')
                if({{quePageData.currentPage == quePageData.totalPages}})
                    $('#page_next').addClass('disabled')

                $('#page_pre > a').click((e) => {
                    if({{quePageData.currentPage == 1}})
                        e.preventDefault()
                })
                $('#page_next > a').click((e) => {
                    if({{quePageData.currentPage == quePageData.totalPages}})
                        e.preventDefault()
                })
            });

            //md 文本编辑器
            var testEditor = editormd("editormd", {
                width: "90%",
                height: 640,
                syncScrolling: "single",
                saveHTMLToTextarea : true,
                path: "/static/editor/lib/"
            });

            function checkForm() {
                return true
            }

            function subme() {
                // console.log(testEditor.getHTML());
                $('#txt_html').val(testEditor.getHTML())
                $('#txt_md').val(testEditor.getMarkdown())
                alert($('#txt_html').val());
                if (checkForm()) {
                    $('#form1').submit()
                }
            }
        </script>
    </body>

</html>