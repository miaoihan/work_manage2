<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Document</title>
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/static/editor/css/editormd.css">
    <link rel="stylesheet" href="/static/css/materialize.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body>
    <!--导航栏-->
    <nav class="nav-top">
            <div class="nav-wrapper"> <a href="/" class="left brand-logo" style="font-size:22px;">码蜂社</a>
                <ul id="nav-mobile" class="right" style="margin-right: 20px">
                    {% if user %}
                    <li>你好，{{user.username}}</li>
                    <li><a href="/user/logout">登出</a></li>
                    {% else %}
                    <li><a href="/user/login">登录</a></li>
                    <li><a href="/user/register">注册</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
    <div class="container">
        <!--面包屑-->
        <div class="crumbs-wrapper zcard content-20"> <a href="#!" class="">首页</a> / <a href="#!" class="">论坛</a> / <a href="#!" class="active">前端</a>
        </div>
        <div class="row">
            <div class="col m12 s12">
                <div class="zcard que-dtl">
                    <h2>{{question.title}}</h2>
                    <div class="que-meta">
                        <span>118</span>
                        <span>56</span>
                        <span>{{question.created_time | parseTime}}</span>
                    </div>
                    <div class="que-content">
                        {{question.content_html | safe}}
                    </div>
                </div>
                <div class="ans-text">
                        {% if user %}
                        <a class="modal-trigger waves-effect waves-light btn right" type="submit" name="action" 
                                style="background: #ef1255;margin:10px 0 20px;"
                                href="#modal1">回复
                        </a>
                        {% else %}
                        <a class="btn waves-effect waves-light right" 
                            href="/user/login" 
                            style="background: #ef1255;margin:10px 0 20px;"
                            >登陆后回复
                        </a>
                        {% endif %}
                </div>
                <div class="clear"></div>
                <div class="ans-list">
                    {% for answer in answerList %}
                    <div class="ans-item row zcard">
                        <div class="col">
                            <div class="ans-avator">
                                <img src="/static/imgs/t2.jpg" alt="" class="avator">
                            </div>
                        </div>
                        <div class="col s10" style="margin:5px 0 10px -10px;">
                            <div class="meta">
                                <span>{{user.username}}</span>
                                <span>{{answer.created_time | parseTime}}</span>
                            </div>
                            <div class="ans-content">
                                {{answer.content_html | safe}}
                            </div>
                            <div style="margin-top:10px;color:#8590a6;">
                                <span></span>
                                <span>回复</span>
                            </div>
                        </div>
                    </div>
                    <!-- 回复的回复 -->
                    {% if answer.comment %}
                    <div class="ans-item row zcard" style="margin-left: 50px;">
                        <div class="col">
                            <div class="ans-avator">
                                <img src="/static/imgs/t2.jpg" alt="" class="avator">
                            </div>
                        </div>
                        <div class="col s10" style="margin:5px 0 10px -10px;">
                            <div class="meta">
                                <span>steven</span>
                                <span>{{answer.comment.created_time | parseTime}}</span>
                            </div>
                            <div class="ans-content">
                                {{answer.comment.content_html | safe}}
                            </div>
                            <div style="margin-top:10px;color:#8590a6;">
                                <span></span>
                                <a href="/answer/comment">回复</a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                    <!-- end item -->
                   
                    <div class="seemore-wrap">
                        <a href="" class="btn seemore">查看更多</a>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    <!-- markdown editor -->
        <!-- Modal Structure -->
        <div id="modal1" class="modal bottom-sheet" style="max-height:90%;padding: 20px 0">
            <form id="form1" action="/answer/answer" method="post">
                <!-- 保存该回答的主题的id -->
                <input type="hidden" value="{{question.id}}" name="q_id">
                <div class="clear"></div>
                <div id="editormd" style="margin-bottom:20px">
                    <textarea name="content_md" id="txt_md"></textarea>
                </div>
                <input name="content_html" id="txt_html" type="hidden">
            </form>
            <div class="e-t-wrapp">
                <a class="btn right" onclick="subme()">提交</a>
            </div>
        </div>
    <footer>
        <div class="Copyright ">
            Copyright © 2016 码蜂社 京公网安备 26015792005034号
        </div>
    </footer>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/materialize.min.js"></script>
    <script src='/static/editor/editormd.min.js'></script>
</body>
<script>
    //md 文本编辑器
    var testEditor = editormd("editormd", {
        width: "90%",
        height: 640,
        syncScrolling: "single",
        saveHTMLToTextarea : true,
        path: "/static/editor/lib/"
    });

    function checkForm() {
        return true
    }

    function subme() {
        $('#txt_html').val(testEditor.getHTML())
        if (checkForm()) {
            $('#form1').submit()
        }
    }
    
    $(document).ready(function() {
        // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
        $('.modal').modal();
    })
</script>
</html>